<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Analysis of Common Agricultural Designs in R</title>
  <meta name="description" content="A series of guidance, tutorials and examples for dealing with the data analysis of experiments following common agricultural designs using R and RStudio">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="Analysis of Common Agricultural Designs in R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="A series of guidance, tutorials and examples for dealing with the data analysis of experiments following common agricultural designs using R and RStudio" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Analysis of Common Agricultural Designs in R" />
  
  <meta name="twitter:description" content="A series of guidance, tutorials and examples for dealing with the data analysis of experiments following common agricultural designs using R and RStudio" />
  

<meta name="author" content="Sam Dumble">


<meta name="date" content="2018-11-14">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="index.html">
<link rel="next" href="randomised-complete-block-design-rcbd.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Minimal Book Example</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Preface</a></li>
<li class="chapter" data-level="2" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>2</b> Introduction</a><ul>
<li class="chapter" data-level="2.1" data-path="intro.html"><a href="intro.html#general-structure-r-syntax"><i class="fa fa-check"></i><b>2.1</b> General Structure: R Syntax</a><ul>
<li class="chapter" data-level="2.1.1" data-path="intro.html"><a href="intro.html#step-1-load-libraries"><i class="fa fa-check"></i><b>2.1.1</b> Step 1: Load Libraries</a></li>
<li class="chapter" data-level="2.1.2" data-path="intro.html"><a href="intro.html#step-2-import-data"><i class="fa fa-check"></i><b>2.1.2</b> Step 2: Import Data</a></li>
<li class="chapter" data-level="2.1.3" data-path="intro.html"><a href="intro.html#step-3-check-and-update-data"><i class="fa fa-check"></i><b>2.1.3</b> Step 3: Check and update data</a></li>
<li class="chapter" data-level="2.1.4" data-path="intro.html"><a href="intro.html#step-4.-explore-data"><i class="fa fa-check"></i><b>2.1.4</b> Step 4. Explore data</a></li>
<li class="chapter" data-level="2.1.5" data-path="intro.html"><a href="intro.html#step-5.-specify-a-model-for-data"><i class="fa fa-check"></i><b>2.1.5</b> Step 5. Specify a model for data</a></li>
<li class="chapter" data-level="2.1.6" data-path="intro.html"><a href="intro.html#step-6.-check-the-model"><i class="fa fa-check"></i><b>2.1.6</b> Step 6. Check the model</a></li>
<li class="chapter" data-level="2.1.7" data-path="intro.html"><a href="intro.html#step-7.-interpret-the-model"><i class="fa fa-check"></i><b>2.1.7</b> Step 7. Interpret the model</a></li>
<li class="chapter" data-level="2.1.8" data-path="intro.html"><a href="intro.html#step-8.-present-the-results-from-the-model"><i class="fa fa-check"></i><b>2.1.8</b> Step 8. Present the results from the model</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="intro.html"><a href="intro.html#general-structure-explanation-of-each-step"><i class="fa fa-check"></i><b>2.2</b> General Structure: Explanation of Each Step</a><ul>
<li class="chapter" data-level="2.2.1" data-path="intro.html"><a href="intro.html#step-1-load-libraries-1"><i class="fa fa-check"></i><b>2.2.1</b> Step 1: Load Libraries</a></li>
<li class="chapter" data-level="2.2.2" data-path="intro.html"><a href="intro.html#step-2-import-data-1"><i class="fa fa-check"></i><b>2.2.2</b> Step 2: Import Data</a></li>
<li class="chapter" data-level="2.2.3" data-path="intro.html"><a href="intro.html#step-3-check-and-update-data-1"><i class="fa fa-check"></i><b>2.2.3</b> Step 3: Check and update data</a></li>
<li class="chapter" data-level="2.2.4" data-path="intro.html"><a href="intro.html#step-4.-explore-data-1"><i class="fa fa-check"></i><b>2.2.4</b> Step 4. Explore data</a></li>
<li class="chapter" data-level="2.2.5" data-path="intro.html"><a href="intro.html#step-5.-specify-a-model-for-data-1"><i class="fa fa-check"></i><b>2.2.5</b> Step 5. Specify a model for data</a></li>
<li class="chapter" data-level="2.2.6" data-path="intro.html"><a href="intro.html#step-6.-check-the-model-1"><i class="fa fa-check"></i><b>2.2.6</b> Step 6. Check the model</a></li>
<li class="chapter" data-level="2.2.7" data-path="intro.html"><a href="intro.html#step-7.-interpret-the-model-1"><i class="fa fa-check"></i><b>2.2.7</b> Step 7. Interpret the model</a></li>
<li class="chapter" data-level="2.2.8" data-path="intro.html"><a href="intro.html#step-8.-present-the-results-from-the-model-1"><i class="fa fa-check"></i><b>2.2.8</b> Step 8. Present the results from the model</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="intro.html"><a href="intro.html#other-resources"><i class="fa fa-check"></i><b>2.3</b> Other resources</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="randomised-complete-block-design-rcbd.html"><a href="randomised-complete-block-design-rcbd.html"><i class="fa fa-check"></i><b>3</b> Randomised Complete Block Design (RCBD)</a><ul>
<li class="chapter" data-level="3.1" data-path="randomised-complete-block-design-rcbd.html"><a href="randomised-complete-block-design-rcbd.html#about-the-data"><i class="fa fa-check"></i><b>3.1</b> About the data</a></li>
<li class="chapter" data-level="3.2" data-path="randomised-complete-block-design-rcbd.html"><a href="randomised-complete-block-design-rcbd.html#section-1-steps-in-analysis-using-r"><i class="fa fa-check"></i><b>3.2</b> Section 1: Steps in analysis using R</a></li>
<li class="chapter" data-level="3.3" data-path="randomised-complete-block-design-rcbd.html"><a href="randomised-complete-block-design-rcbd.html#section-2-explanation-of-steps"><i class="fa fa-check"></i><b>3.3</b> Section 2: Explanation of Steps</a><ul>
<li class="chapter" data-level="3.3.1" data-path="randomised-complete-block-design-rcbd.html"><a href="randomised-complete-block-design-rcbd.html#install-r-packages-needed"><i class="fa fa-check"></i><b>3.3.1</b> 1. Install R packages needed</a></li>
<li class="chapter" data-level="3.3.2" data-path="randomised-complete-block-design-rcbd.html"><a href="randomised-complete-block-design-rcbd.html#import-data"><i class="fa fa-check"></i><b>3.3.2</b> 2. Import data</a></li>
<li class="chapter" data-level="3.3.3" data-path="randomised-complete-block-design-rcbd.html"><a href="randomised-complete-block-design-rcbd.html#check-and-update-data"><i class="fa fa-check"></i><b>3.3.3</b> 3. Check and update data</a></li>
<li class="chapter" data-level="3.3.4" data-path="randomised-complete-block-design-rcbd.html"><a href="randomised-complete-block-design-rcbd.html#explore-data"><i class="fa fa-check"></i><b>3.3.4</b> 4. Explore data</a></li>
<li class="chapter" data-level="3.3.5" data-path="randomised-complete-block-design-rcbd.html"><a href="randomised-complete-block-design-rcbd.html#specify-a-model-for-data"><i class="fa fa-check"></i><b>3.3.5</b> 5. Specify a model for data</a></li>
<li class="chapter" data-level="3.3.6" data-path="randomised-complete-block-design-rcbd.html"><a href="randomised-complete-block-design-rcbd.html#check-the-model"><i class="fa fa-check"></i><b>3.3.6</b> 6. Check the model</a></li>
<li class="chapter" data-level="3.3.7" data-path="randomised-complete-block-design-rcbd.html"><a href="randomised-complete-block-design-rcbd.html#interpret-model"><i class="fa fa-check"></i><b>3.3.7</b> 7. Interpret Model</a></li>
<li class="chapter" data-level="3.3.8" data-path="randomised-complete-block-design-rcbd.html"><a href="randomised-complete-block-design-rcbd.html#present-the-results-from-the-model"><i class="fa fa-check"></i><b>3.3.8</b> 8. Present the results from the model</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="randomised-complete-block-design-rcbd.html"><a href="randomised-complete-block-design-rcbd.html#section-3-methodological-principles"><i class="fa fa-check"></i><b>3.4</b> Section 3 – Methodological Principles</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="split-plot-designs.html"><a href="split-plot-designs.html"><i class="fa fa-check"></i><b>4</b> Split Plot Designs</a><ul>
<li class="chapter" data-level="4.1" data-path="split-plot-designs.html"><a href="split-plot-designs.html#about-the-data-1"><i class="fa fa-check"></i><b>4.1</b> About the data</a></li>
<li class="chapter" data-level="4.2" data-path="split-plot-designs.html"><a href="split-plot-designs.html#section-1-steps-in-analysis-using-r-1"><i class="fa fa-check"></i><b>4.2</b> Section 1: Steps in analysis using R</a></li>
<li class="chapter" data-level="4.3" data-path="split-plot-designs.html"><a href="split-plot-designs.html#section-2-explanation-of-steps-1"><i class="fa fa-check"></i><b>4.3</b> Section 2: Explanation of Steps</a><ul>
<li class="chapter" data-level="4.3.1" data-path="split-plot-designs.html"><a href="split-plot-designs.html#install-r-packages-needed-1"><i class="fa fa-check"></i><b>4.3.1</b> 1. Install R packages needed</a></li>
<li class="chapter" data-level="4.3.2" data-path="split-plot-designs.html"><a href="split-plot-designs.html#import-data-1"><i class="fa fa-check"></i><b>4.3.2</b> 2. Import data</a></li>
<li class="chapter" data-level="4.3.3" data-path="split-plot-designs.html"><a href="split-plot-designs.html#check-and-update-data-1"><i class="fa fa-check"></i><b>4.3.3</b> 3. Check and update data</a></li>
<li class="chapter" data-level="4.3.4" data-path="split-plot-designs.html"><a href="split-plot-designs.html#explore-data-1"><i class="fa fa-check"></i><b>4.3.4</b> 4. Explore data</a></li>
<li class="chapter" data-level="4.3.5" data-path="split-plot-designs.html"><a href="split-plot-designs.html#plots-1"><i class="fa fa-check"></i><b>4.3.5</b> Plots</a></li>
<li class="chapter" data-level="4.3.6" data-path="split-plot-designs.html"><a href="split-plot-designs.html#summary-statistics-1"><i class="fa fa-check"></i><b>4.3.6</b> Summary Statistics</a></li>
<li class="chapter" data-level="4.3.7" data-path="split-plot-designs.html"><a href="split-plot-designs.html#specify-a-model-for-data-1"><i class="fa fa-check"></i><b>4.3.7</b> 5. Specify a model for data</a></li>
<li class="chapter" data-level="4.3.8" data-path="split-plot-designs.html"><a href="split-plot-designs.html#check-the-model-1"><i class="fa fa-check"></i><b>4.3.8</b> 6. Check the model</a></li>
<li class="chapter" data-level="4.3.9" data-path="split-plot-designs.html"><a href="split-plot-designs.html#interpret-model-1"><i class="fa fa-check"></i><b>4.3.9</b> 7. Interpret Model</a></li>
<li class="chapter" data-level="4.3.10" data-path="split-plot-designs.html"><a href="split-plot-designs.html#present-the-results-from-the-model-1"><i class="fa fa-check"></i><b>4.3.10</b> 8. Present the results from the model</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="split-plot-designs.html"><a href="split-plot-designs.html#section-3-methodological-principles-1"><i class="fa fa-check"></i><b>4.4</b> Section 3 – Methodological Principles</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="adjusting-for-covariates.html"><a href="adjusting-for-covariates.html"><i class="fa fa-check"></i><b>5</b> Adjusting for Covariates</a><ul>
<li class="chapter" data-level="5.1" data-path="adjusting-for-covariates.html"><a href="adjusting-for-covariates.html#about-the-data-2"><i class="fa fa-check"></i><b>5.1</b> About the data</a></li>
<li class="chapter" data-level="5.2" data-path="adjusting-for-covariates.html"><a href="adjusting-for-covariates.html#section-1-steps-in-analysis-using-r-2"><i class="fa fa-check"></i><b>5.2</b> Section 1: Steps in analysis using R</a></li>
<li class="chapter" data-level="5.3" data-path="adjusting-for-covariates.html"><a href="adjusting-for-covariates.html#section-2-explanation-of-steps-2"><i class="fa fa-check"></i><b>5.3</b> Section 2: Explanation of Steps</a><ul>
<li class="chapter" data-level="5.3.1" data-path="adjusting-for-covariates.html"><a href="adjusting-for-covariates.html#install-r-packages-needed-2"><i class="fa fa-check"></i><b>5.3.1</b> 1. Install R packages needed</a></li>
<li class="chapter" data-level="5.3.2" data-path="adjusting-for-covariates.html"><a href="adjusting-for-covariates.html#import-data-2"><i class="fa fa-check"></i><b>5.3.2</b> 2. Import data</a></li>
<li class="chapter" data-level="5.3.3" data-path="adjusting-for-covariates.html"><a href="adjusting-for-covariates.html#check-and-update-data-2"><i class="fa fa-check"></i><b>5.3.3</b> 3. Check and update data</a></li>
<li class="chapter" data-level="5.3.4" data-path="adjusting-for-covariates.html"><a href="adjusting-for-covariates.html#explore-data-2"><i class="fa fa-check"></i><b>5.3.4</b> 4. Explore data</a></li>
<li class="chapter" data-level="5.3.5" data-path="adjusting-for-covariates.html"><a href="adjusting-for-covariates.html#specify-a-model-for-data-2"><i class="fa fa-check"></i><b>5.3.5</b> 5. Specify a model for data</a></li>
<li class="chapter" data-level="5.3.6" data-path="adjusting-for-covariates.html"><a href="adjusting-for-covariates.html#check-the-model-2"><i class="fa fa-check"></i><b>5.3.6</b> 6. Check the model</a></li>
<li class="chapter" data-level="5.3.7" data-path="adjusting-for-covariates.html"><a href="adjusting-for-covariates.html#interpret-model-2"><i class="fa fa-check"></i><b>5.3.7</b> 7. Interpret Model</a></li>
<li class="chapter" data-level="5.3.8" data-path="adjusting-for-covariates.html"><a href="adjusting-for-covariates.html#present-the-results-from-the-model-2"><i class="fa fa-check"></i><b>5.3.8</b> 8. Present the results from the model</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="adjusting-for-covariates.html"><a href="adjusting-for-covariates.html#section-3-methodological-principles-2"><i class="fa fa-check"></i><b>5.4</b> Section 3 – Methodological Principles</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="relay-planting-example.html"><a href="relay-planting-example.html"><i class="fa fa-check"></i><b>6</b> Relay Planting Example</a><ul>
<li class="chapter" data-level="6.1" data-path="relay-planting-example.html"><a href="relay-planting-example.html#section-1-steps-in-analysis-using-r-3"><i class="fa fa-check"></i><b>6.1</b> Section 1: Steps in analysis using R</a></li>
<li class="chapter" data-level="6.2" data-path="relay-planting-example.html"><a href="relay-planting-example.html#section-2-explanation-of-steps-3"><i class="fa fa-check"></i><b>6.2</b> Section 2: Explanation of Steps</a><ul>
<li class="chapter" data-level="6.2.1" data-path="relay-planting-example.html"><a href="relay-planting-example.html#install-r-packages-needed-3"><i class="fa fa-check"></i><b>6.2.1</b> 1. Install R packages needed</a></li>
<li class="chapter" data-level="6.2.2" data-path="relay-planting-example.html"><a href="relay-planting-example.html#import-data-3"><i class="fa fa-check"></i><b>6.2.2</b> 2. Import data</a></li>
<li class="chapter" data-level="6.2.3" data-path="relay-planting-example.html"><a href="relay-planting-example.html#check-and-update-data-3"><i class="fa fa-check"></i><b>6.2.3</b> 3. Check and update data</a></li>
<li class="chapter" data-level="6.2.4" data-path="relay-planting-example.html"><a href="relay-planting-example.html#explore-data-3"><i class="fa fa-check"></i><b>6.2.4</b> 4. Explore data</a></li>
<li class="chapter" data-level="6.2.5" data-path="relay-planting-example.html"><a href="relay-planting-example.html#specify-a-model-for-data-3"><i class="fa fa-check"></i><b>6.2.5</b> 5. Specify a model for data</a></li>
<li class="chapter" data-level="6.2.6" data-path="relay-planting-example.html"><a href="relay-planting-example.html#check-the-model-3"><i class="fa fa-check"></i><b>6.2.6</b> 6. Check the model</a></li>
<li class="chapter" data-level="6.2.7" data-path="relay-planting-example.html"><a href="relay-planting-example.html#interpret-model-3"><i class="fa fa-check"></i><b>6.2.7</b> 7. Interpret Model</a></li>
<li class="chapter" data-level="6.2.8" data-path="relay-planting-example.html"><a href="relay-planting-example.html#present-the-results-from-the-model-3"><i class="fa fa-check"></i><b>6.2.8</b> 8. Present the results from the model</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="relay-planting-example.html"><a href="relay-planting-example.html#section-3-methodological-principles-3"><i class="fa fa-check"></i><b>6.3</b> Section 3 – Methodological Principles</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="multi-environment-trial-analysis.html"><a href="multi-environment-trial-analysis.html"><i class="fa fa-check"></i><b>7</b> Multi-Environment Trial Analysis</a><ul>
<li class="chapter" data-level="7.1" data-path="multi-environment-trial-analysis.html"><a href="multi-environment-trial-analysis.html#section-1-steps-in-analysis-using-r-4"><i class="fa fa-check"></i><b>7.1</b> Section 1: Steps in analysis using R</a></li>
<li class="chapter" data-level="7.2" data-path="multi-environment-trial-analysis.html"><a href="multi-environment-trial-analysis.html#section-2-explanation-of-steps-4"><i class="fa fa-check"></i><b>7.2</b> Section 2: Explanation of Steps</a><ul>
<li class="chapter" data-level="7.2.1" data-path="multi-environment-trial-analysis.html"><a href="multi-environment-trial-analysis.html#install-r-packages-needed-4"><i class="fa fa-check"></i><b>7.2.1</b> 1. Install R packages needed</a></li>
<li class="chapter" data-level="7.2.2" data-path="multi-environment-trial-analysis.html"><a href="multi-environment-trial-analysis.html#import-data-4"><i class="fa fa-check"></i><b>7.2.2</b> 2. Import data</a></li>
<li class="chapter" data-level="7.2.3" data-path="multi-environment-trial-analysis.html"><a href="multi-environment-trial-analysis.html#check-and-update-data-4"><i class="fa fa-check"></i><b>7.2.3</b> 3. Check and update data</a></li>
<li class="chapter" data-level="7.2.4" data-path="multi-environment-trial-analysis.html"><a href="multi-environment-trial-analysis.html#explore-data-4"><i class="fa fa-check"></i><b>7.2.4</b> 4. Explore data</a></li>
<li class="chapter" data-level="7.2.5" data-path="multi-environment-trial-analysis.html"><a href="multi-environment-trial-analysis.html#specify-a-model-for-data-4"><i class="fa fa-check"></i><b>7.2.5</b> 5. Specify a model for data</a></li>
<li class="chapter" data-level="7.2.6" data-path="multi-environment-trial-analysis.html"><a href="multi-environment-trial-analysis.html#check-the-model-4"><i class="fa fa-check"></i><b>7.2.6</b> 6. Check the model</a></li>
<li class="chapter" data-level="7.2.7" data-path="multi-environment-trial-analysis.html"><a href="multi-environment-trial-analysis.html#interpret-model-4"><i class="fa fa-check"></i><b>7.2.7</b> 7. Interpret Model</a></li>
<li class="chapter" data-level="7.2.8" data-path="multi-environment-trial-analysis.html"><a href="multi-environment-trial-analysis.html#present-the-results-from-the-model-4"><i class="fa fa-check"></i><b>7.2.8</b> 8. Present the results from the model</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="multi-environment-trial-analysis.html"><a href="multi-environment-trial-analysis.html#section-3-methodological-principles-4"><i class="fa fa-check"></i><b>7.3</b> Section 3 – Methodological Principles</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Analysis of Common Agricultural Designs in R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="intro" class="section level1">
<h1><span class="header-section-number">Chapter 2</span> Introduction</h1>
<p>Different designs require different models. But in R, nearly all other steps are identical before and after model fitting – assuming that, regardless of the design, you are interested in more or less the same question:</p>
<p>Assessing how a numeric response variable (e.g. yield) varies by a treatment factor, or factors.</p>
<p>Being able to learn and understand these steps, will let you analyse any data you have available from on-station trials! In these guides we will use the lmer function within R to fit (nearly) all the models we may want to consider for these agricultural designs. This fits a linear mixed effects regression model. A detailed explanation of these statistical models, and their applicability to agricultural analyses can be found here: <a href="https://www.jic.ac.uk/services/statistics/readingadvice/booklets/topmix.html" class="uri">https://www.jic.ac.uk/services/statistics/readingadvice/booklets/topmix.html</a> . In short, these models enable us to separate out factors that are of interest to us (e.g. treatments, varieties) to factors which are not of interest to us, but that still introduce (e.g. blocks). On-farm trials, less standard designs, and more complex outcome variables (e.g. disease scores, incidence rates, growth patterns) may require more care with analysis and more consideration in how to analyse and interpret results. Many of the general principles are the same, as is a large portion of the R syntax, but in these cases more care is needed to ensure a coherent analysis. There is no “recipe” which will work in the same way every time, each analysis may bring up new or unexpected considerations that need to be addressed rather than forcing the analysis to fit within a standard framework.</p>
<div id="general-structure-r-syntax" class="section level2">
<h2><span class="header-section-number">2.1</span> General Structure: R Syntax</h2>
<div id="step-1-load-libraries" class="section level3">
<h3><span class="header-section-number">2.1.1</span> Step 1: Load Libraries</h3>
<pre><code>library(ggplot2)
library(emmeans)
library(doBy)
library(lmerTest)
library(multcompView)</code></pre>
</div>
<div id="step-2-import-data" class="section level3">
<h3><span class="header-section-number">2.1.2</span> Step 2: Import Data</h3>
<pre><code>mydata &lt;- read.csv(&quot;C:/Users/Admin/Desktop/mydata.csv&quot;)</code></pre>
</div>
<div id="step-3-check-and-update-data" class="section level3">
<h3><span class="header-section-number">2.1.3</span> Step 3: Check and update data</h3>
<pre><code>summary(mydata)
str(mydata)
mydata$treatment&lt;-factor(mydata$treatment)</code></pre>
</div>
<div id="step-4.-explore-data" class="section level3">
<h3><span class="header-section-number">2.1.4</span> Step 4. Explore data</h3>
<pre><code>ggplot(data= mydata,aes(y=response,x=treatment,col= block))+
geom_point()

summaryBy(response ~ treatment, data= mydata, FUN=c(mean,median,sd))</code></pre>
</div>
<div id="step-5.-specify-a-model-for-data" class="section level3">
<h3><span class="header-section-number">2.1.5</span> Step 5. Specify a model for data</h3>
<pre><code>mymodel &lt;-lmer(response~treatment+(1|block), data=mydata)</code></pre>
</div>
<div id="step-6.-check-the-model" class="section level3">
<h3><span class="header-section-number">2.1.6</span> Step 6. Check the model</h3>
<pre><code>plot(mymodel)

qqnorm(resid(mymodel))
qqline(resid(mymodel))</code></pre>
</div>
<div id="step-7.-interpret-the-model" class="section level3">
<h3><span class="header-section-number">2.1.7</span> Step 7. Interpret the model</h3>
<pre><code>anova(mymodel, ddf=&quot;Kenward-Roger&quot;)
print(VarCorr(mymodel), comp=(&quot;Variance&quot;))</code></pre>
</div>
<div id="step-8.-present-the-results-from-the-model" class="section level3">
<h3><span class="header-section-number">2.1.8</span> Step 8. Present the results from the model</h3>
<pre><code>emmip(mymodel,~treatment,CIs = TRUE)
emmeans(mymodel, ~ treatment)
cld(emmeans(mymodel, ~ treatment))</code></pre>
</div>
</div>
<div id="general-structure-explanation-of-each-step" class="section level2">
<h2><span class="header-section-number">2.2</span> General Structure: Explanation of Each Step</h2>
<div id="step-1-load-libraries-1" class="section level3">
<h3><span class="header-section-number">2.2.1</span> Step 1: Load Libraries</h3>
<p>R is an open-source piece of software. One major benefit of this is that many useful functions for importing, manipulating, analysing and presenting data have been created by other R users, beyond what is available in the “base” R packages. Many of these functions are implemented in packages, or libraries, which need to be downloaded and installed separately from your main R and RStudio installation. The main ones you will need to be able to follow this set of guides are: <code>ggplot2</code>: A powerful graphing package, allowing high quality graphs to be produced <code>doBy</code>: A package for easy and customisable calculations of summary statistics <code>lmerTest</code>: A package for fitting and evaluating linear mixed effects regression models, using REML (restricted maximum likelihood) methods as found in Genstat <code>emmeans</code>: A package to calculate estimated marginal means and confidence intervals from statistical models. Similar to EMMEANS in Genstat or LSMEANS in SAS. <code>multcompView</code>: A package for conducting mean separation analysis from mixed effects regression models To install these packages onto your computer you need an internet connection, and for a clean installation of R and RStudio onto your computer. You only need to install an R package once, using install.packages() or through the menus, but you do need to load the packages every time you come to use them using library(). You can learn more about libraries here: <a href="https://www.datacamp.com/community/tutorials/r-packages-guide" class="uri">https://www.datacamp.com/community/tutorials/r-packages-guide</a></p>
</div>
<div id="step-2-import-data-1" class="section level3">
<h3><span class="header-section-number">2.2.2</span> Step 2: Import Data</h3>
<pre><code>mydata &lt;- read.csv(&quot;C:/Users/Admin/Desktop/mydata.csv&quot;)</code></pre>
<p>Key things to consider before even attempting to read your data into R: • Is your data in a single sheet, in a continuous rectangle, with no blank rows or columns? • Is there a single row at the top of your data containing the variable names? • Are the variable names concise, but informative, and contain no spaces or punctuation? • Are missing values consistently coded in your dataset? • Are factor levels consistently coded in your dataset (even including case sensitive – R will consider “treatment A” and “Treatment a” as 2 different treatments. • If you have dates in your data then are they always written in the same format? You can learn more about some of the important considerations of preparing your data for importing into R here: <a href="http://www.sthda.com/english/wiki/best-practices-in-preparing-data-files-for-importing-into-r" class="uri">http://www.sthda.com/english/wiki/best-practices-in-preparing-data-files-for-importing-into-r</a></p>
</div>
<div id="step-3-check-and-update-data-1" class="section level3">
<h3><span class="header-section-number">2.2.3</span> Step 3: Check and update data</h3>
<p>There can be many unforeseen issues when importing your dataset if it is not cleaned in the way you would like it to be. Checking the data, both visually, and using functions like summary() and str() can help you see if there have been any issues which may need addressing. Common problems you might see at this point would be: • Variable names changing: if your variable names contained spaces, or punctuation, then R will change them and introduce extra dots into the name. Ideally you want variable names in R to be concise, and contain no punctuation. This will make writing the syntax much easier • Missing value codes: If you have missing values in your dataset, check that R has imported these as missing values. If in Excel you have a blank cell then this will be imported correctly into R. If you are using a code (like -999 for example) R will not automatically recognise this as a missing value. • Factors being treated as numbers</p>
<p>These are largely the same concerns as in step 2; but being checked from within R rather than within Excel.</p>
<p>Why is it important to make sure factor variables are treated as factors?</p>
<p>We are often taught to use codes when entering and collecting data for categorical variables, such as treatment or variety. If we use numeric codes, i.e. 1,2,3,4 for 4 treatments, then we can potentially see problems with our analysis unless we specify explicitly that this is the case. This problem is not an issue is we use non-numeric codes for treatments, e.g. A,B,C,D. The same data is presented below twice; once with estimates of the treatment means from an analysis of a numeric treatment variable and once from a factor treatment variable.</p>
<p>With the numeric variable the model tries to fit the treatment effect as if it is a continuous scale; i.e. that treatment 2 is 1 point higher than treatment 1. With the factor variable the model treats all 4 treatment groups as being independent of each other. In this case if we had not converted the treatment to a factor we would have had a completely useless model, telling us that there was no treatment effect and providing severe over-estimates of treatments 2 and 4 and a sever underestimate of treatment 3. In fact there is a very highly significant treatment effect in this data, which can only be identified from the analysis when the variable is treated as a factor.</p>
</div>
<div id="step-4.-explore-data-1" class="section level3">
<h3><span class="header-section-number">2.2.4</span> Step 4. Explore data</h3>
<p>Exploratory analysis helps us to understand the results we have found in our data. It can show us • if there are clear effects from visual inspection • the magnitude of any effects, • the variability in our results • if our data is distributed in a way that will lead to a standard modelling approach We can also calculate summary statistics, such as means and percentages.</p>
<p><a href="http://r4ds.had.co.nz/exploratory-data-analysis.html" class="uri">http://r4ds.had.co.nz/exploratory-data-analysis.html</a></p>
</div>
<div id="step-5.-specify-a-model-for-data-1" class="section level3">
<h3><span class="header-section-number">2.2.5</span> Step 5. Specify a model for data</h3>
<pre><code>mymodel &lt;-lmer(response~treatment+(1|block),data=mydata)</code></pre>
<p>Cross link to slides of examples for model construction.</p>
</div>
<div id="step-6.-check-the-model-1" class="section level3">
<h3><span class="header-section-number">2.2.6</span> Step 6. Check the model</h3>
<pre><code>plot(mymodel)</code></pre>
<p>There are three main assumptions that are worthwhile considering when assessing if the model being fitted is valid from a statistical perspective. 1. “Independence”: This assumption can be met by including the dependencies within the design of the experiment within the model through the use of random effects. For example - two plots within the same block, may have some level of inter-relatedness. Including a “block” term in the model allows this assumption to be met in this instance. 2. “Homogeneity”: This assumption relates to whether the variability in each treatment group is similar. In order to calculate standard errors and p-values from the model an assumption is made that there is constant variance across all treatments. If this assumption does not hold then these standard errors and p-values will not be accurate. It is common in many situations to have more variability in high yielding treatments than in low yielding treatments. E.g. 4 treatments, each replicated 8 times</p>
</div>
<div id="step-7.-interpret-the-model-1" class="section level3">
<h3><span class="header-section-number">2.2.7</span> Step 7. Interpret the model</h3>
<pre><code>anova(mymodel, ddf=&quot;Kenward-Roger&quot;)
print(VarCorr(mymodel), comp=(&quot;Variance&quot;))</code></pre>
<p>Summary of Kenward-Rogers degree of freedom from mixed models: <a href="https://www.jstatsoft.org/article/view/v082i13/v82i13.pdf" class="uri">https://www.jstatsoft.org/article/view/v082i13/v82i13.pdf</a></p>
</div>
<div id="step-8.-present-the-results-from-the-model-1" class="section level3">
<h3><span class="header-section-number">2.2.8</span> Step 8. Present the results from the model</h3>
<pre><code>emmip(mymodel,~treatment,CIs = TRUE)
emmeans(mymodel, ~ treatment)
cld(emmeans(mymodel, ~ treatment))
</code></pre>
<p><a href="https://cran.r-project.org/web/packages/emmeans/vignettes/basics.html" class="uri">https://cran.r-project.org/web/packages/emmeans/vignettes/basics.html</a> <a href="https://cran.r-project.org/web/packages/emmeans/vignettes/interactions.html" class="uri">https://cran.r-project.org/web/packages/emmeans/vignettes/interactions.html</a></p>
</div>
</div>
<div id="other-resources" class="section level2">
<h2><span class="header-section-number">2.3</span> Other resources</h2>
<p>For other agricultural trials, particularly if you have slightly different hypotheses to this standard framework, this provides a useful resource and overview of using R for agricultural analyses: <a href="http://rstats4ag.org" class="uri">http://rstats4ag.org</a> There are also specific examples of agricultural experiments with more complex designs, particularly in dealing with repeated measurements over time, in an R package called agriTutorial, which provides 5 specific case-studies of analysing field trial data in R. <a href="https://cran.r-project.org/web/packages/agriTutorial/agriTutorial.pdf" class="uri">https://cran.r-project.org/web/packages/agriTutorial/agriTutorial.pdf</a></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="randomised-complete-block-design-rcbd.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/01-intro.Rmd",
"text": "Edit"
},
"download": ["bookdown-demo.pdf", "bookdown-demo.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
