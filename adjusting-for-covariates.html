<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Analysis of Common Agricultural Designs in R</title>
  <meta name="description" content="A series of guidance, tutorials and examples for dealing with the data analysis of experiments following common agricultural designs using R and RStudio">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="Analysis of Common Agricultural Designs in R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="A series of guidance, tutorials and examples for dealing with the data analysis of experiments following common agricultural designs using R and RStudio" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Analysis of Common Agricultural Designs in R" />
  
  <meta name="twitter:description" content="A series of guidance, tutorials and examples for dealing with the data analysis of experiments following common agricultural designs using R and RStudio" />
  

<meta name="author" content="Sam Dumble">


<meta name="date" content="2018-11-14">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="split-plot-designs.html">
<link rel="next" href="relay-planting-example.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Minimal Book Example</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Preface</a></li>
<li class="chapter" data-level="2" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>2</b> Introduction</a><ul>
<li class="chapter" data-level="2.1" data-path="intro.html"><a href="intro.html#general-structure-r-syntax"><i class="fa fa-check"></i><b>2.1</b> General Structure: R Syntax</a><ul>
<li class="chapter" data-level="2.1.1" data-path="intro.html"><a href="intro.html#step-1-load-libraries"><i class="fa fa-check"></i><b>2.1.1</b> Step 1: Load Libraries</a></li>
<li class="chapter" data-level="2.1.2" data-path="intro.html"><a href="intro.html#step-2-import-data"><i class="fa fa-check"></i><b>2.1.2</b> Step 2: Import Data</a></li>
<li class="chapter" data-level="2.1.3" data-path="intro.html"><a href="intro.html#step-3-check-and-update-data"><i class="fa fa-check"></i><b>2.1.3</b> Step 3: Check and update data</a></li>
<li class="chapter" data-level="2.1.4" data-path="intro.html"><a href="intro.html#step-4.-explore-data"><i class="fa fa-check"></i><b>2.1.4</b> Step 4. Explore data</a></li>
<li class="chapter" data-level="2.1.5" data-path="intro.html"><a href="intro.html#step-5.-specify-a-model-for-data"><i class="fa fa-check"></i><b>2.1.5</b> Step 5. Specify a model for data</a></li>
<li class="chapter" data-level="2.1.6" data-path="intro.html"><a href="intro.html#step-6.-check-the-model"><i class="fa fa-check"></i><b>2.1.6</b> Step 6. Check the model</a></li>
<li class="chapter" data-level="2.1.7" data-path="intro.html"><a href="intro.html#step-7.-interpret-the-model"><i class="fa fa-check"></i><b>2.1.7</b> Step 7. Interpret the model</a></li>
<li class="chapter" data-level="2.1.8" data-path="intro.html"><a href="intro.html#step-8.-present-the-results-from-the-model"><i class="fa fa-check"></i><b>2.1.8</b> Step 8. Present the results from the model</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="intro.html"><a href="intro.html#general-structure-explanation-of-each-step"><i class="fa fa-check"></i><b>2.2</b> General Structure: Explanation of Each Step</a><ul>
<li class="chapter" data-level="2.2.1" data-path="intro.html"><a href="intro.html#step-1-load-libraries-1"><i class="fa fa-check"></i><b>2.2.1</b> Step 1: Load Libraries</a></li>
<li class="chapter" data-level="2.2.2" data-path="intro.html"><a href="intro.html#step-2-import-data-1"><i class="fa fa-check"></i><b>2.2.2</b> Step 2: Import Data</a></li>
<li class="chapter" data-level="2.2.3" data-path="intro.html"><a href="intro.html#step-3-check-and-update-data-1"><i class="fa fa-check"></i><b>2.2.3</b> Step 3: Check and update data</a></li>
<li class="chapter" data-level="2.2.4" data-path="intro.html"><a href="intro.html#step-4.-explore-data-1"><i class="fa fa-check"></i><b>2.2.4</b> Step 4. Explore data</a></li>
<li class="chapter" data-level="2.2.5" data-path="intro.html"><a href="intro.html#step-5.-specify-a-model-for-data-1"><i class="fa fa-check"></i><b>2.2.5</b> Step 5. Specify a model for data</a></li>
<li class="chapter" data-level="2.2.6" data-path="intro.html"><a href="intro.html#step-6.-check-the-model-1"><i class="fa fa-check"></i><b>2.2.6</b> Step 6. Check the model</a></li>
<li class="chapter" data-level="2.2.7" data-path="intro.html"><a href="intro.html#step-7.-interpret-the-model-1"><i class="fa fa-check"></i><b>2.2.7</b> Step 7. Interpret the model</a></li>
<li class="chapter" data-level="2.2.8" data-path="intro.html"><a href="intro.html#step-8.-present-the-results-from-the-model-1"><i class="fa fa-check"></i><b>2.2.8</b> Step 8. Present the results from the model</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="intro.html"><a href="intro.html#other-resources"><i class="fa fa-check"></i><b>2.3</b> Other resources</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="randomised-complete-block-design-rcbd.html"><a href="randomised-complete-block-design-rcbd.html"><i class="fa fa-check"></i><b>3</b> Randomised Complete Block Design (RCBD)</a><ul>
<li class="chapter" data-level="3.1" data-path="randomised-complete-block-design-rcbd.html"><a href="randomised-complete-block-design-rcbd.html#about-the-data"><i class="fa fa-check"></i><b>3.1</b> About the data</a></li>
<li class="chapter" data-level="3.2" data-path="randomised-complete-block-design-rcbd.html"><a href="randomised-complete-block-design-rcbd.html#section-1-steps-in-analysis-using-r"><i class="fa fa-check"></i><b>3.2</b> Section 1: Steps in analysis using R</a></li>
<li class="chapter" data-level="3.3" data-path="randomised-complete-block-design-rcbd.html"><a href="randomised-complete-block-design-rcbd.html#section-2-explanation-of-steps"><i class="fa fa-check"></i><b>3.3</b> Section 2: Explanation of Steps</a><ul>
<li class="chapter" data-level="3.3.1" data-path="randomised-complete-block-design-rcbd.html"><a href="randomised-complete-block-design-rcbd.html#install-r-packages-needed"><i class="fa fa-check"></i><b>3.3.1</b> 1. Install R packages needed</a></li>
<li class="chapter" data-level="3.3.2" data-path="randomised-complete-block-design-rcbd.html"><a href="randomised-complete-block-design-rcbd.html#import-data"><i class="fa fa-check"></i><b>3.3.2</b> 2. Import data</a></li>
<li class="chapter" data-level="3.3.3" data-path="randomised-complete-block-design-rcbd.html"><a href="randomised-complete-block-design-rcbd.html#check-and-update-data"><i class="fa fa-check"></i><b>3.3.3</b> 3. Check and update data</a></li>
<li class="chapter" data-level="3.3.4" data-path="randomised-complete-block-design-rcbd.html"><a href="randomised-complete-block-design-rcbd.html#explore-data"><i class="fa fa-check"></i><b>3.3.4</b> 4. Explore data</a></li>
<li class="chapter" data-level="3.3.5" data-path="randomised-complete-block-design-rcbd.html"><a href="randomised-complete-block-design-rcbd.html#specify-a-model-for-data"><i class="fa fa-check"></i><b>3.3.5</b> 5. Specify a model for data</a></li>
<li class="chapter" data-level="3.3.6" data-path="randomised-complete-block-design-rcbd.html"><a href="randomised-complete-block-design-rcbd.html#check-the-model"><i class="fa fa-check"></i><b>3.3.6</b> 6. Check the model</a></li>
<li class="chapter" data-level="3.3.7" data-path="randomised-complete-block-design-rcbd.html"><a href="randomised-complete-block-design-rcbd.html#interpret-model"><i class="fa fa-check"></i><b>3.3.7</b> 7. Interpret Model</a></li>
<li class="chapter" data-level="3.3.8" data-path="randomised-complete-block-design-rcbd.html"><a href="randomised-complete-block-design-rcbd.html#present-the-results-from-the-model"><i class="fa fa-check"></i><b>3.3.8</b> 8. Present the results from the model</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="randomised-complete-block-design-rcbd.html"><a href="randomised-complete-block-design-rcbd.html#section-3-methodological-principles"><i class="fa fa-check"></i><b>3.4</b> Section 3 – Methodological Principles</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="split-plot-designs.html"><a href="split-plot-designs.html"><i class="fa fa-check"></i><b>4</b> Split Plot Designs</a><ul>
<li class="chapter" data-level="4.1" data-path="split-plot-designs.html"><a href="split-plot-designs.html#about-the-data-1"><i class="fa fa-check"></i><b>4.1</b> About the data</a></li>
<li class="chapter" data-level="4.2" data-path="split-plot-designs.html"><a href="split-plot-designs.html#section-1-steps-in-analysis-using-r-1"><i class="fa fa-check"></i><b>4.2</b> Section 1: Steps in analysis using R</a></li>
<li class="chapter" data-level="4.3" data-path="split-plot-designs.html"><a href="split-plot-designs.html#section-2-explanation-of-steps-1"><i class="fa fa-check"></i><b>4.3</b> Section 2: Explanation of Steps</a><ul>
<li class="chapter" data-level="4.3.1" data-path="split-plot-designs.html"><a href="split-plot-designs.html#install-r-packages-needed-1"><i class="fa fa-check"></i><b>4.3.1</b> 1. Install R packages needed</a></li>
<li class="chapter" data-level="4.3.2" data-path="split-plot-designs.html"><a href="split-plot-designs.html#import-data-1"><i class="fa fa-check"></i><b>4.3.2</b> 2. Import data</a></li>
<li class="chapter" data-level="4.3.3" data-path="split-plot-designs.html"><a href="split-plot-designs.html#check-and-update-data-1"><i class="fa fa-check"></i><b>4.3.3</b> 3. Check and update data</a></li>
<li class="chapter" data-level="4.3.4" data-path="split-plot-designs.html"><a href="split-plot-designs.html#explore-data-1"><i class="fa fa-check"></i><b>4.3.4</b> 4. Explore data</a></li>
<li class="chapter" data-level="4.3.5" data-path="split-plot-designs.html"><a href="split-plot-designs.html#plots-1"><i class="fa fa-check"></i><b>4.3.5</b> Plots</a></li>
<li class="chapter" data-level="4.3.6" data-path="split-plot-designs.html"><a href="split-plot-designs.html#summary-statistics-1"><i class="fa fa-check"></i><b>4.3.6</b> Summary Statistics</a></li>
<li class="chapter" data-level="4.3.7" data-path="split-plot-designs.html"><a href="split-plot-designs.html#specify-a-model-for-data-1"><i class="fa fa-check"></i><b>4.3.7</b> 5. Specify a model for data</a></li>
<li class="chapter" data-level="4.3.8" data-path="split-plot-designs.html"><a href="split-plot-designs.html#check-the-model-1"><i class="fa fa-check"></i><b>4.3.8</b> 6. Check the model</a></li>
<li class="chapter" data-level="4.3.9" data-path="split-plot-designs.html"><a href="split-plot-designs.html#interpret-model-1"><i class="fa fa-check"></i><b>4.3.9</b> 7. Interpret Model</a></li>
<li class="chapter" data-level="4.3.10" data-path="split-plot-designs.html"><a href="split-plot-designs.html#present-the-results-from-the-model-1"><i class="fa fa-check"></i><b>4.3.10</b> 8. Present the results from the model</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="split-plot-designs.html"><a href="split-plot-designs.html#section-3-methodological-principles-1"><i class="fa fa-check"></i><b>4.4</b> Section 3 – Methodological Principles</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="adjusting-for-covariates.html"><a href="adjusting-for-covariates.html"><i class="fa fa-check"></i><b>5</b> Adjusting for Covariates</a><ul>
<li class="chapter" data-level="5.1" data-path="adjusting-for-covariates.html"><a href="adjusting-for-covariates.html#about-the-data-2"><i class="fa fa-check"></i><b>5.1</b> About the data</a></li>
<li class="chapter" data-level="5.2" data-path="adjusting-for-covariates.html"><a href="adjusting-for-covariates.html#section-1-steps-in-analysis-using-r-2"><i class="fa fa-check"></i><b>5.2</b> Section 1: Steps in analysis using R</a></li>
<li class="chapter" data-level="5.3" data-path="adjusting-for-covariates.html"><a href="adjusting-for-covariates.html#section-2-explanation-of-steps-2"><i class="fa fa-check"></i><b>5.3</b> Section 2: Explanation of Steps</a><ul>
<li class="chapter" data-level="5.3.1" data-path="adjusting-for-covariates.html"><a href="adjusting-for-covariates.html#install-r-packages-needed-2"><i class="fa fa-check"></i><b>5.3.1</b> 1. Install R packages needed</a></li>
<li class="chapter" data-level="5.3.2" data-path="adjusting-for-covariates.html"><a href="adjusting-for-covariates.html#import-data-2"><i class="fa fa-check"></i><b>5.3.2</b> 2. Import data</a></li>
<li class="chapter" data-level="5.3.3" data-path="adjusting-for-covariates.html"><a href="adjusting-for-covariates.html#check-and-update-data-2"><i class="fa fa-check"></i><b>5.3.3</b> 3. Check and update data</a></li>
<li class="chapter" data-level="5.3.4" data-path="adjusting-for-covariates.html"><a href="adjusting-for-covariates.html#explore-data-2"><i class="fa fa-check"></i><b>5.3.4</b> 4. Explore data</a></li>
<li class="chapter" data-level="5.3.5" data-path="adjusting-for-covariates.html"><a href="adjusting-for-covariates.html#specify-a-model-for-data-2"><i class="fa fa-check"></i><b>5.3.5</b> 5. Specify a model for data</a></li>
<li class="chapter" data-level="5.3.6" data-path="adjusting-for-covariates.html"><a href="adjusting-for-covariates.html#check-the-model-2"><i class="fa fa-check"></i><b>5.3.6</b> 6. Check the model</a></li>
<li class="chapter" data-level="5.3.7" data-path="adjusting-for-covariates.html"><a href="adjusting-for-covariates.html#interpret-model-2"><i class="fa fa-check"></i><b>5.3.7</b> 7. Interpret Model</a></li>
<li class="chapter" data-level="5.3.8" data-path="adjusting-for-covariates.html"><a href="adjusting-for-covariates.html#present-the-results-from-the-model-2"><i class="fa fa-check"></i><b>5.3.8</b> 8. Present the results from the model</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="adjusting-for-covariates.html"><a href="adjusting-for-covariates.html#section-3-methodological-principles-2"><i class="fa fa-check"></i><b>5.4</b> Section 3 – Methodological Principles</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="relay-planting-example.html"><a href="relay-planting-example.html"><i class="fa fa-check"></i><b>6</b> Relay Planting Example</a><ul>
<li class="chapter" data-level="6.1" data-path="relay-planting-example.html"><a href="relay-planting-example.html#section-1-steps-in-analysis-using-r-3"><i class="fa fa-check"></i><b>6.1</b> Section 1: Steps in analysis using R</a></li>
<li class="chapter" data-level="6.2" data-path="relay-planting-example.html"><a href="relay-planting-example.html#section-2-explanation-of-steps-3"><i class="fa fa-check"></i><b>6.2</b> Section 2: Explanation of Steps</a><ul>
<li class="chapter" data-level="6.2.1" data-path="relay-planting-example.html"><a href="relay-planting-example.html#install-r-packages-needed-3"><i class="fa fa-check"></i><b>6.2.1</b> 1. Install R packages needed</a></li>
<li class="chapter" data-level="6.2.2" data-path="relay-planting-example.html"><a href="relay-planting-example.html#import-data-3"><i class="fa fa-check"></i><b>6.2.2</b> 2. Import data</a></li>
<li class="chapter" data-level="6.2.3" data-path="relay-planting-example.html"><a href="relay-planting-example.html#check-and-update-data-3"><i class="fa fa-check"></i><b>6.2.3</b> 3. Check and update data</a></li>
<li class="chapter" data-level="6.2.4" data-path="relay-planting-example.html"><a href="relay-planting-example.html#explore-data-3"><i class="fa fa-check"></i><b>6.2.4</b> 4. Explore data</a></li>
<li class="chapter" data-level="6.2.5" data-path="relay-planting-example.html"><a href="relay-planting-example.html#specify-a-model-for-data-3"><i class="fa fa-check"></i><b>6.2.5</b> 5. Specify a model for data</a></li>
<li class="chapter" data-level="6.2.6" data-path="relay-planting-example.html"><a href="relay-planting-example.html#check-the-model-3"><i class="fa fa-check"></i><b>6.2.6</b> 6. Check the model</a></li>
<li class="chapter" data-level="6.2.7" data-path="relay-planting-example.html"><a href="relay-planting-example.html#interpret-model-3"><i class="fa fa-check"></i><b>6.2.7</b> 7. Interpret Model</a></li>
<li class="chapter" data-level="6.2.8" data-path="relay-planting-example.html"><a href="relay-planting-example.html#present-the-results-from-the-model-3"><i class="fa fa-check"></i><b>6.2.8</b> 8. Present the results from the model</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="relay-planting-example.html"><a href="relay-planting-example.html#section-3-methodological-principles-3"><i class="fa fa-check"></i><b>6.3</b> Section 3 – Methodological Principles</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="multi-environment-trial-analysis.html"><a href="multi-environment-trial-analysis.html"><i class="fa fa-check"></i><b>7</b> Multi-Environment Trial Analysis</a><ul>
<li class="chapter" data-level="7.1" data-path="multi-environment-trial-analysis.html"><a href="multi-environment-trial-analysis.html#section-1-steps-in-analysis-using-r-4"><i class="fa fa-check"></i><b>7.1</b> Section 1: Steps in analysis using R</a></li>
<li class="chapter" data-level="7.2" data-path="multi-environment-trial-analysis.html"><a href="multi-environment-trial-analysis.html#section-2-explanation-of-steps-4"><i class="fa fa-check"></i><b>7.2</b> Section 2: Explanation of Steps</a><ul>
<li class="chapter" data-level="7.2.1" data-path="multi-environment-trial-analysis.html"><a href="multi-environment-trial-analysis.html#install-r-packages-needed-4"><i class="fa fa-check"></i><b>7.2.1</b> 1. Install R packages needed</a></li>
<li class="chapter" data-level="7.2.2" data-path="multi-environment-trial-analysis.html"><a href="multi-environment-trial-analysis.html#import-data-4"><i class="fa fa-check"></i><b>7.2.2</b> 2. Import data</a></li>
<li class="chapter" data-level="7.2.3" data-path="multi-environment-trial-analysis.html"><a href="multi-environment-trial-analysis.html#check-and-update-data-4"><i class="fa fa-check"></i><b>7.2.3</b> 3. Check and update data</a></li>
<li class="chapter" data-level="7.2.4" data-path="multi-environment-trial-analysis.html"><a href="multi-environment-trial-analysis.html#explore-data-4"><i class="fa fa-check"></i><b>7.2.4</b> 4. Explore data</a></li>
<li class="chapter" data-level="7.2.5" data-path="multi-environment-trial-analysis.html"><a href="multi-environment-trial-analysis.html#specify-a-model-for-data-4"><i class="fa fa-check"></i><b>7.2.5</b> 5. Specify a model for data</a></li>
<li class="chapter" data-level="7.2.6" data-path="multi-environment-trial-analysis.html"><a href="multi-environment-trial-analysis.html#check-the-model-4"><i class="fa fa-check"></i><b>7.2.6</b> 6. Check the model</a></li>
<li class="chapter" data-level="7.2.7" data-path="multi-environment-trial-analysis.html"><a href="multi-environment-trial-analysis.html#interpret-model-4"><i class="fa fa-check"></i><b>7.2.7</b> 7. Interpret Model</a></li>
<li class="chapter" data-level="7.2.8" data-path="multi-environment-trial-analysis.html"><a href="multi-environment-trial-analysis.html#present-the-results-from-the-model-4"><i class="fa fa-check"></i><b>7.2.8</b> 8. Present the results from the model</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="multi-environment-trial-analysis.html"><a href="multi-environment-trial-analysis.html#section-3-methodological-principles-4"><i class="fa fa-check"></i><b>7.3</b> Section 3 – Methodological Principles</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Analysis of Common Agricultural Designs in R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="adjusting-for-covariates" class="section level1">
<h1><span class="header-section-number">Chapter 5</span> Adjusting for Covariates</h1>
<div id="about-the-data-2" class="section level2">
<h2><span class="header-section-number">5.1</span> About the data</h2>
<p>The data used in this example is from a study was conducted in Eastern Zambia and the main aim was to improve on the efficiency of the natural fallows by using appropriate trees that may have relevance in soil fertility regeneration within permissible fallow periods. This is the same data used in the first part of this series.</p>
<p>The design was a randomized complete block design experiment with 4 blocks and 9 treatments was conducted. The primary outcome variable was crop yield (yield). We also have data collected on striga infestation.</p>
<p>The objective for this analysis is to investigate the relationship between striga infestation and yield across the different treatments.</p>
<p>The following steps were followed to generate the output in this document. The data was organized in excel rectangle columns with the different variables appearing in excel columns. All data checks were done in excel, meaningful data was selected and a copy of this data file was stored as a CSV file to make data import easy in R. The data file used in this analysis can be downloaded here: <a href="https://bit.ly/2rfLBEt" class="uri">https://bit.ly/2rfLBEt</a></p>
</div>
<div id="section-1-steps-in-analysis-using-r-2" class="section level2">
<h2><span class="header-section-number">5.2</span> Section 1: Steps in analysis using R</h2>
<ol style="list-style-type: decimal">
<li>Install R packages needed</li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggplot2)
<span class="kw">library</span>(emmeans)
<span class="kw">library</span>(doBy)
<span class="kw">library</span>(lmerTest)
<span class="kw">library</span>(multcompView)</code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>Import data</li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fallow &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;C:/Users/Admin/Desktop/Fallow N2.csv&quot;</span>)</code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li>Check and update data</li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(fallow)
<span class="kw">str</span>(fallow)
fallow<span class="op">$</span>rep&lt;-<span class="kw">factor</span>(fallow<span class="op">$</span>rep)
fallow<span class="op">$</span>plot&lt;-<span class="kw">factor</span>(fallow<span class="op">$</span>plot)</code></pre></div>
<ol start="4" style="list-style-type: decimal">
<li>Explore data</li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data=</span>fallow,<span class="kw">aes</span>(<span class="dt">y=</span>yield,<span class="dt">x=</span>treat,<span class="dt">col=</span>rep))<span class="op">+</span><span class="kw">geom_point</span>()
<span class="kw">summaryBy</span>(yield<span class="op">~</span>treat, <span class="dt">data=</span>fallow, <span class="dt">FUN=</span><span class="kw">c</span>(min,max,mean,median,sd))</code></pre></div>
<ol start="5" style="list-style-type: decimal">
<li>Specify a model for data</li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">rcbdmodel1&lt;-<span class="kw">lmer</span>(yield<span class="op">~</span>treat<span class="op">+</span>(<span class="dv">1</span><span class="op">|</span>rep),<span class="dt">data=</span>fallow)</code></pre></div>
<ol start="6" style="list-style-type: decimal">
<li>Check the model</li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(rcbdmodel1)

<span class="kw">qqnorm</span>(<span class="kw">resid</span>(rcbdmodel1))
<span class="kw">qqline</span>(<span class="kw">resid</span>(rcbdmodel1))</code></pre></div>
<ol start="7" style="list-style-type: decimal">
<li>Interpret the model</li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">anova</span>(rcbdmodel1,<span class="dt">ddf=</span><span class="st">&quot;Kenward-Roger&quot;</span>)
<span class="kw">print</span>(<span class="kw">VarCorr</span>(rcbdmodel1), <span class="dt">comp=</span>(<span class="st">&quot;Variance&quot;</span>))</code></pre></div>
<ol start="8" style="list-style-type: decimal">
<li>Present the results from the model</li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">emmip</span>(rcbdmodel1,<span class="op">~</span>treat,<span class="dt">CIs =</span> <span class="ot">TRUE</span>)
<span class="kw">emmeans</span>(rcbdmodel1, <span class="op">~</span>treat)
<span class="kw">cld</span>(<span class="kw">emmeans</span>(rcbdmodel1, <span class="op">~</span>treat))</code></pre></div>
</div>
<div id="section-2-explanation-of-steps-2" class="section level2">
<h2><span class="header-section-number">5.3</span> Section 2: Explanation of Steps</h2>
<div id="install-r-packages-needed-2" class="section level3">
<h3><span class="header-section-number">5.3.1</span> 1. Install R packages needed</h3>
<p>A number of packages following packages were used during data exploration and analysis. For a general introduction explaining what R packages are and how they work, this is a really useful guide <a href="https://www.datacamp.com/community/tutorials/r-packages-guide" class="uri">https://www.datacamp.com/community/tutorials/r-packages-guide</a>. For each of these packages to be installed, using install.packages(), this requires a reliable internet connection and a correctly installed version of R and RStudio. If you are having difficulties installing these packages please ask for help.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">install.packages</span>(<span class="st">&quot;ggplot2&quot;</span>)
<span class="kw">library</span>(ggplot2)</code></pre></div>
<p><code>ggplot2</code> This package provides a powerful graphics language for creating elegant and complex graphs in R.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">install.packages</span>(<span class="st">&quot;emmeans&quot;</span>)
<span class="kw">library</span>(emmeans)</code></pre></div>
<p><code>emmeans</code> Estimated marginal means (also known as least squares means) helps provide expected mean values and confidence intervals from statistical models.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">install.packages</span>(<span class="st">&quot;doBy&quot;</span>)
<span class="kw">library</span>(doBy)</code></pre></div>
<p><code>doBy</code>Allows easy production of summary statistic tables</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">install.packages</span>(<span class="st">&quot;lmerTest&quot;</span>)
<span class="kw">library</span>(lmerTest)</code></pre></div>
<p><code>lmerTest</code> Allows produce of flexible mixed effects regression models, similar to REML in Genstat.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">install.packages</span>(<span class="st">&quot;multcompView&quot;</span>)
<span class="kw">library</span>(multcompView)</code></pre></div>
<p><code>multcompView</code> allows for mean seperation methods on analyses</p>
</div>
<div id="import-data-2" class="section level3">
<h3><span class="header-section-number">5.3.2</span> 2. Import data</h3>
<p>Our data set saved as a CSV file, so we can use the read.csv commmand to import the data. We are going to assign the name of the data with R to be <code>fallow2</code>. Remember in R Studio you could also use the “Import Dataset” menu to import a dataset.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fallow &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;C:/Users/Admin/Desktop/Fallow N2.csv&quot;</span>)</code></pre></div>
</div>
<div id="check-and-update-data-2" class="section level3">
<h3><span class="header-section-number">5.3.3</span> 3. Check and update data</h3>
<p>When reading data into R it is always useful to check that data is in the format expected. How many variables are there? How many rows? How have the columns been read in? The summary command can help to show if the data is being treated correctly.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(fallow)</code></pre></div>
<pre><code>##       rep            plot            treat        yield      
##  Min.   :1.00   Min.   :1   1 S.sesban  : 4   Min.   :1.140  
##  1st Qu.:1.75   1st Qu.:3   2 G.sepium  : 4   1st Qu.:2.370  
##  Median :2.50   Median :5   3 L.leuco   : 4   Median :3.140  
##  Mean   :2.50   Mean   :5   4 F.congesta: 4   Mean   :3.232  
##  3rd Qu.:3.25   3rd Qu.:7   5 C.siamea  : 4   3rd Qu.:3.728  
##  Max.   :4.00   Max.   :9   6 C.calo    : 4   Max.   :6.540  
##                             (Other)     :12                  
##      striga      
##  Min.   :   0.0  
##  1st Qu.:   0.0  
##  Median :  21.0  
##  Mean   : 334.1  
##  3rd Qu.: 238.5  
##  Max.   :2798.0  
## </code></pre>
<p>Where data is being treated as a numeric variable (i.e. a number) <code>summary</code> provides statistics like the mean, min and max. Where data is being treated like a categorical variable (i.e. a group) then summary provides frequency tables.</p>
<p>From the results we can see that the variables rep and plot are being considered as numeric variables. However these are grouping variables, not number variables, the numbers used are simply codes. If we do not rectify this then our analysis later will be incorrect and meaningless.<br />
This can also be seen more explicitly using the str() function.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">str</span>(fallow)</code></pre></div>
<pre><code>## &#39;data.frame&#39;:    36 obs. of  5 variables:
##  $ rep   : int  1 4 4 1 1 3 3 1 3 2 ...
##  $ plot  : int  2 3 6 9 7 3 8 6 9 9 ...
##  $ treat : Factor w/ 9 levels &quot;1 S.sesban&quot;,&quot;2 G.sepium&quot;,..: 8 5 8 7 5 8 5 9 6 5 ...
##  $ yield : num  1.14 1.74 1.95 2.06 2.09 2.15 2.21 2.22 2.34 2.38 ...
##  $ striga: int  2798 0 1787 129 1 1144 0 228 0 0 ...</code></pre>
<p>So we need to convert these variables into factors.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fallow<span class="op">$</span>rep&lt;-<span class="kw">factor</span>(fallow<span class="op">$</span>rep)
fallow<span class="op">$</span>plot&lt;-<span class="kw">factor</span>(fallow<span class="op">$</span>plot)</code></pre></div>
<p>These commands take the column rep within the data frame fallow, converts into a factor and saves the result in a column called rep within fallow.</p>
</div>
<div id="explore-data-2" class="section level3">
<h3><span class="header-section-number">5.3.4</span> 4. Explore data</h3>
<div id="plots-2" class="section level4">
<h4><span class="header-section-number">5.3.4.1</span> Plots</h4>
<p>We are now interesting in assessing the relationship between yield and striga - so we want to produce a plot of striga against yield, with different coloured points denoting each treatment.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data=</span>fallow,<span class="kw">aes</span>(<span class="dt">y=</span>yield,<span class="dt">x=</span>striga,<span class="dt">col=</span>treat))<span class="op">+</span><span class="kw">geom_point</span>()</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-85-1.png" width="672" /> We can see from the distribution of striga that there are some farms with very high levels of striga, and some farms with no striga. The big range of values makes it hard to make interpretations from this plot, so taking a square root transformation may help to visualise the relationship. A log transformation will not help here because of the large number of 0 values of striga.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data=</span>fallow,<span class="kw">aes</span>(<span class="dt">y=</span>yield,<span class="dt">x=</span><span class="kw">sqrt</span>(striga),<span class="dt">col=</span>treat))<span class="op">+</span><span class="kw">geom_point</span>()</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-86-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data=</span>fallow,<span class="kw">aes</span>(<span class="dt">y=</span>yield,<span class="dt">x=</span><span class="kw">sqrt</span>(striga)))<span class="op">+</span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">col=</span>treat))<span class="op">+</span><span class="kw">geom_smooth</span>(<span class="dt">method=</span><span class="st">&quot;lm&quot;</span>)</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-87-1.png" width="672" /> ####Summary Statistics</p>
<p>To produce summary statistics, by group, there are many options within R. One option is to use the summaryBy function, from the doBy library. The code used for this is quite similar to the code we will use to produce models in a later step.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summaryBy</span>(yield<span class="op">~</span>treat, <span class="dt">data=</span>fallow, <span class="dt">FUN=</span>mean)</code></pre></div>
<pre><code>##          treat yield.mean
## 1   1 S.sesban     5.5475
## 2   2 G.sepium     3.8450
## 3    3 L.leuco     3.6750
## 4 4 F.congesta     3.4600
## 5   5 C.siamea     2.1050
## 6     6 C.calo     2.5875
## 7  7 groundnut     3.0825
## 8      8 maize     1.9750
## 9 9 nat fallow     2.8100</code></pre>
<p>We can also calculate multiple statistics in the same line of code</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summaryBy</span>(yield<span class="op">+</span>striga<span class="op">~</span>treat, <span class="dt">data=</span>fallow, <span class="dt">FUN=</span><span class="kw">c</span>(mean,median,sd))</code></pre></div>
<pre><code>##          treat yield.mean striga.mean yield.median striga.median  yield.sd
## 1   1 S.sesban     5.5475        0.25        5.465           0.0 0.7625997
## 2   2 G.sepium     3.8450      712.00        3.900         738.0 0.4956813
## 3    3 L.leuco     3.6750       10.25        3.550           0.0 0.3690077
## 4 4 F.congesta     3.4600      448.00        3.465          25.0 0.2412468
## 5   5 C.siamea     2.1050        0.25        2.150           0.0 0.2708628
## 6     6 C.calo     2.5875       44.00        2.635          35.5 0.1726992
## 7  7 groundnut     3.0825      130.00        3.275         124.5 0.7407372
## 8      8 maize     1.9750     1532.25        2.050        1465.5 0.6318491
## 9 9 nat fallow     2.8100      130.00        2.950         146.0 0.4034848
##    striga.sd
## 1    0.50000
## 2  560.27731
## 3   20.50000
## 4  862.29693
## 5    0.50000
## 6   52.66878
## 7  110.06362
## 8 1016.48885
## 9  105.69453</code></pre>
</div>
</div>
<div id="specify-a-model-for-data-2" class="section level3">
<h3><span class="header-section-number">5.3.5</span> 5. Specify a model for data</h3>
<p>In this design, an RCBD, we have one treatment factor, “treat”, and one layout factor “rep”. More information about model fitting can be found in section 2.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">rcbdmodel2&lt;-<span class="kw">lmer</span>(yield<span class="op">~</span>treat<span class="op">+</span><span class="kw">sqrt</span>(striga)<span class="op">+</span>(<span class="dv">1</span><span class="op">|</span>rep),<span class="dt">data=</span>fallow)</code></pre></div>
<p>R is unlike many other software packages in how it fits models. The best way of handling models in R is to assign the model to a name (in this case rcbdmodel1) and then ask R to provide different sorts of output for this model. When you run the above line you will get now output from the data - this is what we expected to see!</p>
</div>
<div id="check-the-model-2" class="section level3">
<h3><span class="header-section-number">5.3.6</span> 6. Check the model</h3>
<p>Before interpretting the model any further we should investigate the model validity, to ensure any conclusions we draw are valid. There are 3 assumptions that we can check for using standard model checking plots. 1. Homogeneity (equal variance) 2. Values with high leverage 3. Normality of residuals</p>
<p>The function plot() when used with a model will plot the fitted values from the model against the expected values.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(rcbdmodel2)</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-91-1.png" width="672" /> The residual Vs fitted plot is a scatter plot of the Residuals on the y-axis and the fitted on the x-axis and the aim for this plot is to test the assumption of equal variance of the residuals across the range of fitted values. Since the residuals do not funnel out (to form triangular/diamond shape) the assumption of equal variance is met.</p>
<p>We can also see that there are no extreme values in the residuals which might be potentially causing problems with the validity of our conclusions (leverage)</p>
<p>To assess the assumption of normality we can produce a qqplot. This shows us how closely the residuals follow a normal distribution - if there are severe and syste,matic deviations from the line then we may want to consider an alternative distribution.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">qqnorm</span>(<span class="kw">resid</span>(rcbdmodel2))
<span class="kw">qqline</span>(<span class="kw">resid</span>(rcbdmodel2))</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-92-1.png" width="672" /> In this case the residuals seem to fit the assumption required for normality.</p>
</div>
<div id="interpret-model-2" class="section level3">
<h3><span class="header-section-number">5.3.7</span> 7. Interpret Model</h3>
<p>The anova() function only prints the rows of analysis of variance table for treatment effects when looking at a mixed model fitted using lmer().</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">anova</span>(rcbdmodel2,<span class="dt">ddf=</span><span class="st">&quot;Kenward-Roger&quot;</span>)</code></pre></div>
<pre><code>## Type III Analysis of Variance Table with Kenward-Roger&#39;s method
##              Sum Sq Mean Sq NumDF  DenDF F value    Pr(&gt;F)    
## treat        33.253  4.1567     8 23.176 23.6703 2.132e-09 ***
## sqrt(striga)  1.257  1.2568     1 24.977  7.1571   0.01298 *  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>ddf=Kenward-Roger tells R which method to use for determining the calculations of the table; this option matches the defaults found within SAS or Genstat. The ANOVA table suggests a highly significant effect of the treatment on the yield.</p>
<p>To obtain the residual variance, and the variance attributed to the blocks we need an additional command. From these number it is possible to reconstruct a more classic ANOVA table, if so desired.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">print</span>(<span class="kw">VarCorr</span>(rcbdmodel2), <span class="dt">comp=</span>(<span class="st">&quot;Variance&quot;</span>))</code></pre></div>
<pre><code>##  Groups   Name        Variance
##  rep      (Intercept) 0.054136
##  Residual             0.175600</code></pre>
</div>
<div id="present-the-results-from-the-model-2" class="section level3">
<h3><span class="header-section-number">5.3.8</span> 8. Present the results from the model</h3>
<p>To help understand what the significant result from the ANOVA table means we can produce several plots and tables to help us. First we can use the function emmip() to produce plots of the modelled results, including 95% confidence intervals.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">emmip</span>(rcbdmodel2,striga<span class="op">~</span>treat,<span class="dt">var=</span><span class="st">&quot;striga&quot;</span>,<span class="dt">CIs =</span> <span class="ot">TRUE</span>, <span class="dt">at =</span> <span class="kw">list</span>(<span class="dt">striga =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">10</span>,<span class="dv">100</span>,<span class="dv">1000</span>)))</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-95-1.png" width="672" /></p>
<p>Or alternatively</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">emmip</span>(rcbdmodel2,treat<span class="op">~</span>striga,<span class="dt">var=</span><span class="st">&quot;striga&quot;</span>,<span class="dt">at =</span> <span class="kw">list</span>(<span class="dt">striga =</span> <span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">1000</span>,<span class="dt">by=</span><span class="dv">100</span>)))</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-96-1.png" width="672" /></p>
<p>To obtain the numbers used in creating this graph we can use the function emmeans.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">emmeans</span>(rcbdmodel2,<span class="op">~</span>treat<span class="op">*</span>striga,<span class="dt">var=</span><span class="st">&quot;striga&quot;</span>,<span class="dt">at =</span> <span class="kw">list</span>(<span class="dt">striga =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">10</span>,<span class="dv">100</span>,<span class="dv">1000</span>)))</code></pre></div>
<pre><code>##  treat        striga   emmean        SE    df  lower.CL upper.CL
##  1 S.sesban        0 5.553321 0.2396638 18.13 5.0500620 6.056579
##  2 G.sepium        0 4.382568 0.3127465 23.61 3.7365259 5.028609
##  3 L.leuco         0 3.712270 0.2400585 18.17 3.2082694 4.216271
##  4 F.congesta      0 3.755253 0.2638447 20.52 3.2057709 4.304734
##  5 C.siamea        0 2.110821 0.2396638 18.13 1.6075620 2.614079
##  6 C.calo          0 2.696189 0.2430732 18.50 2.1865045 3.205873
##  7 groundnut       0 3.313834 0.2547769 19.69 2.7818499 3.845819
##  8 maize           0 2.842226 0.4031321 25.65 2.0130321 3.671421
##  9 nat fallow      0 3.035732 0.2540738 19.63 2.5050969 3.566367
##  1 S.sesban       10 5.479695 0.2409904 18.28 4.9739401 5.985450
##  2 G.sepium       10 4.308942 0.2958172 22.77 3.6966556 4.921228
##  3 L.leuco        10 3.638644 0.2400389 18.17 3.1346806 4.142608
##  4 F.congesta     10 3.681627 0.2535683 19.58 3.1519610 4.211293
##  5 C.siamea       10 2.037195 0.2409904 18.28 1.5314401 2.542950
##  6 C.calo         10 2.622563 0.2400121 18.17 2.1186500 3.126477
##  7 groundnut      10 3.240209 0.2467978 18.90 2.7234660 3.756951
##  8 maize          10 2.768601 0.3813535 25.41 1.9838290 3.553372
##  9 nat fallow     10 2.962106 0.2463060 18.85 2.4462979 3.477915
##  1 S.sesban      100 5.320496 0.2542321 19.64 4.7895569 5.851435
##  2 G.sepium      100 4.149743 0.2653481 20.65 3.5973441 4.702141
##  3 L.leuco       100 3.479445 0.2505537 19.28 2.9555477 4.003343
##  4 F.congesta    100 3.522428 0.2407873 18.25 3.0170555 4.027800
##  5 C.siamea      100 1.877996 0.2542321 19.64 1.3470569 2.408935
##  6 C.calo        100 2.463364 0.2441046 18.61 1.9517290 2.974999
##  7 groundnut     100 3.081010 0.2396546 18.13 2.5777683 3.584251
##  8 maize         100 2.609402 0.3371451 24.49 1.9143072 3.304496
##  9 nat fallow    100 2.802907 0.2396686 18.13 2.2996397 3.306175
##  1 S.sesban     1000 4.817064 0.3632908 25.12 4.0690284 5.565100
##  2 G.sepium     1000 3.646311 0.2508980 19.32 3.1217555 4.170866
##  3 L.leuco      1000 2.976014 0.3545407 24.94 2.2457305 3.706297
##  4 F.congesta   1000 3.018996 0.2908737 22.48 2.4165111 3.621481
##  5 C.siamea     1000 1.374564 0.3632908 25.12 0.6265284 2.122600
##  6 C.calo       1000 1.959932 0.3353532 24.44 1.2684536 2.651411
##  7 groundnut    1000 2.577578 0.3050497 23.25 1.9469164 3.208239
##  8 maize        1000 2.105970 0.2446031 18.67 1.5933909 2.618549
##  9 nat fallow   1000 2.299476 0.3063498 23.32 1.6662200 2.932731
## 
## Degrees-of-freedom method: kenward-roger 
## Confidence level used: 0.95</code></pre>
<p>And one method for conducting mean separation analysis, holding striga effect constant, we can use the function cld().</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">cld</span>(<span class="kw">emmeans</span>(rcbdmodel2, <span class="op">~</span>treat))</code></pre></div>
<pre><code>##  treat          emmean        SE    df lower.CL upper.CL .group
##  5 C.siamea   1.685247 0.2864468 22.21 1.091515 2.278979  1    
##  6 C.calo     2.270615 0.2673279 20.81 1.714369 2.826862  12   
##  8 maize      2.416653 0.2910113 22.49 1.813896 3.019410  123  
##  9 nat fallow 2.610159 0.2510259 19.33 2.085359 3.134958  123  
##  7 groundnut  2.888261 0.2504107 19.27 2.364636 3.411885   234 
##  3 L.leuco    3.286697 0.2801804 21.79 2.705311 3.868082    34 
##  4 F.congesta 3.329679 0.2445546 18.66 2.817192 3.842166    34 
##  2 G.sepium   3.956994 0.2432827 18.53 3.446913 4.467074     45
##  1 S.sesban   5.127747 0.2864468 22.21 4.534015 5.721479      5
## 
## Degrees-of-freedom method: kenward-roger 
## Confidence level used: 0.95 
## P value adjustment: tukey method for comparing a family of 9 estimates 
## significance level used: alpha = 0.05</code></pre>
<p>In the output, groups sharing a letter in the .group are not statistically different from each other.</p>
</div>
</div>
<div id="section-3-methodological-principles-2" class="section level2">
<h2><span class="header-section-number">5.4</span> Section 3 – Methodological Principles</h2>
<p>When adjusting for covariates it is important to consider if the covariate being included is something that could be affected by the treatment variables, or whether it is something which affects the outcome independent of the treatments. If we were confident that striga infestation was not impacted by the choice of treatment then in this analysis</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="split-plot-designs.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="relay-planting-example.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/04-covariates.Rmd",
"text": "Edit"
},
"download": ["bookdown-demo.pdf", "bookdown-demo.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
